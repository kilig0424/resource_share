{% extends 'base.html' %}

{% block title %}ç”³è¯·çŠ¶æ€ - èµ„æºåˆ†äº«ç«™{% endblock %}

{% block content %}
<div class="auth-container">
    <div class="auth-card">
        <h2 class="auth-title">ä¸Šä¼ æƒé™ç”³è¯·çŠ¶æ€</h2>
        
        {% if messages %}
        <div class="auth-messages">
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}
        
        <div class="status-container">
            <!-- çŠ¶æ€å¡ç‰‡ -->
            <div class="status-card {{ user.apply_status }}">
                <div class="status-header">
                    <div class="status-icon">
                        {% if user.apply_status == 'not_applied' %}
                            ğŸ“
                        {% elif user.apply_status == 'pending' %}
                            â³
                        {% elif user.apply_status == 'approved' %}
                            âœ…
                        {% elif user.apply_status == 'rejected' %}
                            âŒ
                        {% endif %}
                    </div>
                    <div class="status-info">
                        <h3 class="status-title">{{ status_display }}</h3>
                        <p class="status-desc">
                            {% if user.apply_status == 'not_applied' %}
                                æ‚¨è¿˜æœªç”³è¯·ä¸Šä¼ æƒé™
                            {% elif user.apply_status == 'pending' %}
                                æ‚¨çš„ç”³è¯·æ­£åœ¨å®¡æ ¸ä¸­ï¼Œè¯·è€å¿ƒç­‰å¾…
                            {% elif user.apply_status == 'approved' %}
                                æ­å–œï¼æ‚¨çš„ç”³è¯·å·²é€šè¿‡å®¡æ ¸
                            {% elif user.apply_status == 'rejected' %}
                                å¾ˆé—æ†¾ï¼Œæ‚¨çš„ç”³è¯·æœªé€šè¿‡å®¡æ ¸
                            {% endif %}
                        </p>
                    </div>
                </div>
                
                <div class="status-details">
                    {% if user.apply_time %}
                    <div class="detail-item">
                        <span class="detail-label">ç”³è¯·æ—¶é—´ï¼š</span>
                        <span class="detail-value">{{ user.apply_time|date:"Y-m-d H:i" }}</span>
                    </div>
                    {% endif %}
                    
                    {% if user.review_time %}
                    <div class="detail-item">
                        <span class="detail-label">å®¡æ ¸æ—¶é—´ï¼š</span>
                        <span class="detail-value">{{ user.review_time|date:"Y-m-d H:i" }}</span>
                    </div>
                    {% endif %}
                    
                    {% if user.review_message %}
                    <div class="detail-item">
                        <span class="detail-label">å®¡æ ¸å¤‡æ³¨ï¼š</span>
                        <span class="detail-value">{{ user.review_message }}</span>
                    </div>
                    {% endif %}
                    
                    {% if user.upload_permission %}
                    <div class="detail-item">
                        <span class="detail-label">å½“å‰æƒé™ï¼š</span>
                        <span class="detail-value permission-active">å·²å¼€é€šä¸Šä¼ æƒé™</span>
                    </div>
                    {% else %}
                    <div class="detail-item">
                        <span class="detail-label">å½“å‰æƒé™ï¼š</span>
                        <span class="detail-value permission-inactive">æ— ä¸Šä¼ æƒé™</span>
                    </div>
                    {% endif %}
                </div>
            </div>
            
            <!-- æ“ä½œæŒ‰é’® -->
            <div class="action-buttons">
                {% if user.apply_status == 'not_applied' %}
                    <a href="{% url 'accounts:apply_permission' %}" class="action-btn primary-btn">
                        ç«‹å³ç”³è¯·
                    </a>
                {% elif user.apply_status == 'pending' %}
                    <button class="action-btn secondary-btn" disabled>
                        å®¡æ ¸ä¸­ï¼Œè¯·è€å¿ƒç­‰å¾…
                    </button>
                {% elif user.apply_status == 'rejected' %}
                    <a href="{% url 'accounts:apply_permission' %}" class="action-btn primary-btn">
                        é‡æ–°ç”³è¯·
                    </a>
                {% endif %}
                
                {% if user.upload_permission %}
                    <a href="{% url 'core:upload_resource' %}" class="action-btn success-btn">
                        ç«‹å³ä¸Šä¼ èµ„æº
                    </a>
                {% endif %}
                
                <a href="{% url 'core:index' %}" class="action-btn default-btn">
                    è¿”å›é¦–é¡µ
                </a>
            </div>
            
            <!-- çŠ¶æ€è¯´æ˜ -->
            <div class="status-instructions">
                <h4>çŠ¶æ€è¯´æ˜ï¼š</h4>
                <ul>
                    <li><strong>æœªç”³è¯·</strong>ï¼šæ‚¨è¿˜æœªæäº¤ä¸Šä¼ æƒé™ç”³è¯·</li>
                    <li><strong>å®¡æ ¸ä¸­</strong>ï¼šç”³è¯·å·²æäº¤ï¼Œç®¡ç†å‘˜æ­£åœ¨å®¡æ ¸</li>
                    <li><strong>å·²é€šè¿‡</strong>ï¼šç”³è¯·å·²æ‰¹å‡†ï¼Œæ‚¨å¯ä»¥ä¸Šä¼ èµ„æº</li>
                    <li><strong>è¢«æ‹’ç»</strong>ï¼šç”³è¯·æœªé€šè¿‡ï¼Œè¯·æŸ¥çœ‹å®¡æ ¸å¤‡æ³¨</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<style>
    .auth-container {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 70vh;
        padding: 20px;
    }
    
    .auth-card {
        background-color: white;
        border-radius: 10px;
        padding: 40px;
        box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        width: 100%;
        max-width: 600px;
    }
    
    .auth-title {
        text-align: center;
        margin-bottom: 30px;
        color: #333;
        font-size: 24px;
    }
    
    .auth-messages {
        margin-bottom: 20px;
    }
    
    .alert {
        padding: 12px 15px;
        border-radius: 6px;
        margin-bottom: 15px;
        font-size: 14px;
    }
    
    .alert-success {
        background-color: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
    }
    
    .alert-info {
        background-color: #d1ecf1;
        color: #0c5460;
        border: 1px solid #bee5eb;
    }
    
    /* çŠ¶æ€å¡ç‰‡ */
    .status-card {
        border-radius: 10px;
        padding: 25px;
        margin-bottom: 30px;
        border-left: 5px solid #6c757d;
    }
    
    .status-card.not_applied {
        border-left-color: #6c757d;
        background-color: #f8f9fa;
    }
    
    .status-card.pending {
        border-left-color: #ffc107;
        background-color: #fff3cd;
    }
    
    .status-card.approved {
        border-left-color: #28a745;
        background-color: #d4edda;
    }
    
    .status-card.rejected {
        border-left-color: #dc3545;
        background-color: #f8d7da;
    }
    
    .status-header {
        display: flex;
        align-items: center;
        gap: 20px;
        margin-bottom: 20px;
    }
    
    .status-icon {
        font-size: 40px;
    }
    
    .status-info {
        flex: 1;
    }
    
    .status-title {
        margin: 0 0 5px 0;
        color: #333;
        font-size: 20px;
    }
    
    .status-desc {
        margin: 0;
        color: #666;
        font-size: 14px;
    }
    
    /* çŠ¶æ€è¯¦æƒ… */
    .status-details {
        background-color: white;
        border-radius: 8px;
        padding: 20px;
        margin-top: 15px;
    }
    
    .detail-item {
        display: flex;
        margin-bottom: 12px;
        font-size: 14px;
    }
    
    .detail-item:last-child {
        margin-bottom: 0;
    }
    
    .detail-label {
        color: #666;
        min-width: 80px;
        font-weight: 500;
    }
    
    .detail-value {
        color: #333;
        flex: 1;
    }
    
    .permission-active {
        color: #28a745;
        font-weight: 600;
    }
    
    .permission-inactive {
        color: #dc3545;
        font-weight: 600;
    }
    
    /* æ“ä½œæŒ‰é’® */
    .action-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        margin-bottom: 30px;
        justify-content: center;
    }
    
    .action-btn {
        display: inline-block;
        padding: 12px 25px;
        text-decoration: none;
        border-radius: 6px;
        font-size: 16px;
        font-weight: 600;
        text-align: center;
        transition: all 0.3s;
        border: none;
        cursor: pointer;
        min-width: 150px;
    }
    
    .primary-btn {
        background-color: #007bff;
        color: white;
    }
    
    .primary-btn:hover {
        background-color: #0056b3;
        color: white;
    }
    
    .secondary-btn {
        background-color: #6c757d;
        color: white;
        cursor: not-allowed;
    }
    
    .success-btn {
        background-color: #28a745;
        color: white;
    }
    
    .success-btn:hover {
        background-color: #218838;
        color: white;
    }
    
    .default-btn {
        background-color: #e9ecef;
        color: #495057;
    }
    
    .default-btn:hover {
        background-color: #dde0e3;
        color: #495057;
    }
    
    /* çŠ¶æ€è¯´æ˜ */
    .status-instructions {
        background-color: #f8f9fa;
        border-radius: 8px;
        padding: 20px;
        font-size: 14px;
        color: #495057;
    }
    
    .status-instructions h4 {
        color: #333;
        margin-bottom: 10px;
        font-size: 16px;
    }
    
    .status-instructions ul {
        margin-left: 20px;
        margin-bottom: 0;
    }
    
    .status-instructions li {
        margin-bottom: 8px;
    }
    
    .status-instructions strong {
        color: #333;
    }
    
    @media (max-width: 768px) {
        .auth-card {
            padding: 25px 20px;
        }
        
        .auth-title {
            font-size: 20px;
        }
        
        .status-header {
            flex-direction: column;
            text-align: center;
            gap: 10px;
        }
        
        .status-icon {
            font-size: 35px;
        }
        
        .action-buttons {
            flex-direction: column;
        }
        
        .action-btn {
            width: 100%;
        }
        
        .detail-item {
            flex-direction: column;
            gap: 5px;
        }
        
        .detail-label {
            min-width: auto;
        }
    }
</style>
{% endblock %}