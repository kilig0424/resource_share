{% extends 'base.html' %}

{% block title %}{{ resource.title }} - èµ„æºåˆ†äº«ç«™{% endblock %}

{% block description %}
    {% if resource.description %}
        {{ resource.description|striptags|truncatechars:160 }}
    {% else %}
        {{ resource.title }} - ç½‘ç›˜èµ„æºä¸‹è½½
    {% endif %}
{% endblock %}

{% block keywords %}
    {% if resource.keywords %}
        {{ resource.keywords }}
    {% else %}
        {{ resource.category.name }},èµ„æºä¸‹è½½,ç½‘ç›˜èµ„æº
    {% endif %}
{% endblock %}

{% block content %}
<div class="resource-detail-container">
    <!-- é¢åŒ…å±‘å¯¼èˆª -->
    <div class="breadcrumb">
        <a href="/">é¦–é¡µ</a> &gt;
        <a href="#">{{ resource.category.name }}</a> &gt;
        <span>{{ resource.title }}</span>
    </div>

    <!-- èµ„æºåŸºæœ¬ä¿¡æ¯ -->
    <div class="resource-header">
        <h1 class="resource-title">{{ resource.title }}</h1>
        <div class="resource-meta">
            <span class="meta-item">
                <span class="meta-label">åˆ†ç±»ï¼š</span>
                <span class="meta-value">{{ resource.category.name }}</span>
            </span>
            <span class="meta-item">
                <span class="meta-label">ä¸Šä¼ è€…ï¼š</span>
                <span class="meta-value">{{ resource.user.username }}</span>
            </span>
            <span class="meta-item">
                <span class="meta-label">ä¸Šä¼ æ—¶é—´ï¼š</span>
                <span class="meta-value">{{ resource.created_at|date:"Y-m-d H:i" }}</span>
            </span>
            <span class="meta-item">
                <span class="meta-label">æµè§ˆï¼š</span>
                <span class="meta-value">{{ resource.view_count }}æ¬¡</span>
            </span>
        </div>
    </div>

    <!-- èµ„æºæ“ä½œåŒºåŸŸ -->
    <div class="resource-actions">
        <button class="action-btn like-btn" data-resource-id="{{ resource.id }}">
            <span class="icon">ğŸ‘</span>
            <span class="count">{{ resource.like_count }}</span>
        </button>

        <button class="action-btn favorite-btn" data-resource-id="{{ resource.id }}">
            <span class="icon">â­</span>
            <span class="count">{{ resource.collect_count }}</span>
        </button>

        <button class="action-btn comment-btn" data-resource-id="{{ resource.id }}">
            <span class="icon">ğŸ’¬</span>
            <span class="count">{{ resource.comment_count }}</span>
        </button>

        <button class="action-btn report-btn" data-resource-id="{{ resource.id }}">
            <span class="icon">ğŸš¨</span>
            <span class="count">{{ resource.report_count }}</span>
        </button>
    </div>

    <!-- èµ„æºè¯¦æƒ…å†…å®¹ -->
    <div class="resource-content">
        <div class="section">
            <h2 class="section-title">èµ„æºæè¿°</h2>
            <div class="section-content">
                {% if resource.description %}
                    {{ resource.description|linebreaks }}
                {% else %}
                    <p class="no-content">æš‚æ— æè¿°</p>
                {% endif %}
            </div>
        </div>

        <div class="section">
            <h2 class="section-title">èµ„æºä¿¡æ¯</h2>
            <div class="resource-info-grid">
                <div class="info-item">
                    <span class="info-label">ç½‘ç›˜ç±»å‹ï¼š</span>
                    <span class="info-value">{{ resource.cloud_type.name }}</span>
                </div>
        <div class="info-item">
            <span class="info-label">å…³é”®è¯ï¼š</span>
            <span class="info-value">
                {% for keyword in resource.get_keywords_list %}
                    <span class="keyword-tag">{{ keyword }}</span>
                {% empty %}
                    æš‚æ— å…³é”®è¯
                {% endfor %}
                {% if resource.keywords %}
                    <button class="copy-keywords-btn" onclick="copyKeywords()">å¤åˆ¶å…³é”®è¯</button>
                {% endif %}
            </span>
        </div>
                {% if resource.extract_code %}
                <div class="info-item">
                    <span class="info-label">æå–ç ï¼š</span>
                    <span class="info-value">{{ resource.extract_code }}</span>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- èµ„æºé“¾æ¥ -->
        <div class="section link-section">
            <div id="resource-data" data-resource-id="{{ resource.id }}" style="display: none;"></div>
            <h2 class="section-title">èµ„æºé“¾æ¥</h2>
            <div class="link-container">
                <div class="link-box">
                    <input type="text" id="resource-link" value="{{ resource.resource_url }}" readonly class="link-input">
                    <button class="copy-btn" onclick="copyResourceLink()">å¤åˆ¶é“¾æ¥</button>
                </div>
                <a href="{{ resource.resource_url }}" target="_blank" class="direct-link-btn">ç›´æ¥è®¿é—®</a>
            </div>
            <div class="copy-tips" id="copy-tips"></div>
        </div>
        <!-- èµ„æºæˆªå›¾ -->


        {% if resource.screenshot %}
        <div class="section">
            <h2 class="section-title">èµ„æºæˆªå›¾</h2>
            <div class="screenshot-container">
                <img src="{{ resource.screenshot.url }}" alt="èµ„æºæˆªå›¾" class="screenshot-img">
            </div>
        </div>
        {% endif %}
<!-- è¯„è®ºåŒºåŸŸ -->
<div class="comments-section" id="comments-section">
    <h2 class="section-title">è¯„è®ºï¼ˆ{{ resource.comment_count }}æ¡ï¼‰</h2>

    <!-- å‘è¡¨è¯„è®ºè¡¨å• -->
    <div class="comment-form-container">
        <form id="comment-form" class="comment-form">
            {% csrf_token %}
            <div class="form-group">
                <textarea name="content" id="comment-content" class="comment-textarea"
                          placeholder="è¯·è¾“å…¥è¯„è®ºå†…å®¹ï¼ˆä¸è¶…è¿‡200å­—ï¼Œä¸å¯åŒ…å«é“¾æ¥ï¼‰..."
                          maxlength="200" required></textarea>
                <div class="comment-actions">
                    <span class="char-count">0/200</span>
                    <button type="submit" class="submit-comment-btn">å‘è¡¨è¯„è®º</button>
                </div>
            </div>
        </form>
    </div>

    <!-- è¯„è®ºåˆ—è¡¨ -->
    <div class="comments-list" id="comments-list">
        {% for comment in comments %}
        <div class="comment-item" data-comment-id="{{ comment.id }}">
            <div class="comment-header">
                <span class="comment-author">{{ comment.user.username }}</span>
                <span class="comment-time">{{ comment.created_at|date:"Y-m-d H:i" }}</span>
            </div>
            <div class="comment-content">
                {{ comment.content|linebreaks }}
            </div>
            {% if comment.user == user or user.is_staff %}
            <div class="comment-actions">
                <button class="delete-comment-btn" onclick="deleteComment({{ comment.id }})">åˆ é™¤</button>
            </div>
            {% endif %}
        </div>
        {% empty %}
        <div class="no-comments">
            æš‚æ— è¯„è®ºï¼Œå¿«æ¥å‘è¡¨ç¬¬ä¸€æ¡è¯„è®ºå§ï¼
        </div>
        {% endfor %}
    </div>
</div>
    <!-- è¿”å›é¡¶éƒ¨æŒ‰é’® -->
    <div class="back-to-top-container">
        <button class="back-to-top-btn" onclick="smoothScrollToTop()">â†‘ è¿”å›é¡¶éƒ¨</button>
    </div>
<!-- ç›¸å…³èµ„æºæ¨è -->
{% if related_resources %}
<div class="related-resources">
    <h2 class="related-title">ç›¸å…³èµ„æºæ¨è</h2>
    <div class="related-grid">
        {% for related in related_resources %}
        <div class="related-card">
            <div class="related-header">
                <span class="related-category">{{ related.category.name }}</span>
                <span class="related-cloud">{{ related.cloud_type.name }}</span>
            </div>
            <h3 class="related-resource-title">
                <a href="{% url 'core:resource_detail' related.id %}">{{ related.title }}</a>
            </h3>
            <div class="related-meta">
                <span class="related-stats">
                    ğŸ‘ï¸ {{ related.view_count }} | ğŸ‘ {{ related.like_count }}
                </span>
                <span class="related-time">{{ related.created_at|date:"Y-m-d" }}</span>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}

<!-- æ ·å¼ -->
<style>
    .action-btn.reported {
        background-color: #6c757d;
        color: white;
        border-color: #6c757d;
        cursor: not-allowed;
    }

    .action-btn.reported .icon {
        color: white;
    }

    .action-btn.reported:hover {
        background-color: #6c757d;
    }

    .action-btn:disabled {
        opacity: 0.7;
        cursor: not-allowed;
    }
    /* è¿”å›é¡¶éƒ¨æŒ‰é’® */
    .back-to-top-container {
        text-align: center;
        margin-top: 30px;
        padding-top: 20px;
        border-top: 1px solid #dee2e6;
    }

    .back-to-top-btn {
        padding: 10px 25px;
        background-color: #6c757d;
        color: white;
        border: none;
        border-radius: 25px;
        font-size: 14px;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    .back-to-top-btn:hover {
        background-color: #545b62;
    }
    /* ç‚¹å‡»è¯„è®ºæŒ‰é’®æ—¶çš„åé¦ˆæ•ˆæœ */
    .action-btn.clicked {
        animation: pulse 0.3s ease-in-out;
        background-color: #007bff;
        color: white;
    }

    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(0.95); }
        100% { transform: scale(1); }
    }
    /* è¯„è®ºåŒºåŸŸæ ·å¼ */
    .comments-section {
        margin-top: 40px;
        padding: 20px;
        background-color: white;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .comment-form-container {
        margin-bottom: 30px;
        padding: 20px;
        background-color: #f8f9fa;
        border-radius: 8px;
    }

    .comment-form {
        width: 100%;
    }

    .comment-textarea {
        width: 100%;
        min-height: 100px;
        padding: 15px;
        border: 1px solid #ced4da;
        border-radius: 6px;
        font-size: 16px;
        resize: vertical;
        margin-bottom: 10px;
        font-family: inherit;
    }

    .comment-textarea:focus {
        border-color: #007bff;
        outline: none;
        box-shadow: 0 0 0 2px rgba(0,123,255,0.25);
    }

    .comment-actions {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .char-count {
        color: #6c757d;
        font-size: 14px;
    }

    .submit-comment-btn {
        padding: 10px 25px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 16px;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    .submit-comment-btn:hover {
        background-color: #0056b3;
    }

    .submit-comment-btn:disabled {
        background-color: #6c757d;
        cursor: not-allowed;
    }

    .comments-list {
        margin-top: 20px;
    }

    .comment-item {
        padding: 20px;
        margin-bottom: 20px;
        background-color: #f8f9fa;
        border-radius: 8px;
        border-left: 4px solid #007bff;
        position: relative;
    }

    .comment-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
        font-size: 14px;
    }

    .comment-author {
        font-weight: 600;
        color: #007bff;
    }

    .comment-time {
        color: #6c757d;
    }

    .comment-content {
        line-height: 1.6;
        color: #333;
        font-size: 15px;
        margin-bottom: 10px;
    }

    .comment-actions {
        text-align: right;
    }

    .delete-comment-btn {
        padding: 5px 15px;
        background-color: #dc3545;
        color: white;
        border: none;
        border-radius: 4px;
        font-size: 14px;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    .delete-comment-btn:hover {
        background-color: #c82333;
    }

    .no-comments {
        text-align: center;
        padding: 40px 20px;
        color: #6c757d;
        background-color: #f8f9fa;
        border-radius: 8px;
    }

    @media (max-width: 768px) {
        .comments-section {
            padding: 15px;
        }

        .comment-header {
            flex-direction: column;
            gap: 5px;
        }

        .comment-actions {
            flex-direction: column;
            gap: 10px;
        }

        .submit-comment-btn {
            width: 100%;
        }
    }
    .action-btn.favorited {
        background-color: #ffc107;
        color: #212529;
        border-color: #ffc107;
    }
    .action-btn.favorited .icon {
        color: #212529;
    }
    .action-btn.favorited:hover {
        background-color: #e0a800;
        border-color: #e0a800;
    }
     .action-btn.liked {
        background-color: #28a745;
        color: white;
        border-color: #28a745;
    }
    .action-btn.liked .icon {
        color: white;
    }
    .action-btn.liked:hover {
        background-color: #218838;
        border-color: #218838;
    }
    .resource-detail-container {
        background-color: white;
        border-radius: 10px;
        padding: 30px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .copy-keywords-btn {
    margin-left: 10px;
    padding: 6px 15px;  /* å¢åŠ å†…è¾¹è· */
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 6px;  /* ä¸å¤åˆ¶é“¾æ¥æŒ‰é’®ç›¸åŒçš„åœ†è§’ */
    font-size: 13px;     /* ç¨å¾®å¤§ä¸€ç‚¹çš„å­—å· */
    cursor: pointer;
    transition: all 0.3s;
    font-weight: 500;
}
    .copy-keywords-btn:hover {
    background-color: #0056b3;
    transform: translateY(-1px);  /* æ·»åŠ æ‚¬åœæ•ˆæœ */
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}
    .breadcrumb {
        margin-bottom: 20px;
        font-size: 14px;
        color: #666;
    }
    .breadcrumb a {
        color: #007bff;
        text-decoration: none;
    }
    .breadcrumb a:hover {
        text-decoration: underline;
    }

    .resource-header {
        margin-bottom: 20px;
        padding-bottom: 20px;
        border-bottom: 1px solid #eee;
    }
    .resource-title {
        font-size: 28px;
        margin-bottom: 15px;
        color: #333;
        line-height: 1.4;
    }
    .resource-meta {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        font-size: 14px;
        color: #666;
    }
    .meta-item {
        display: flex;
        gap: 5px;
    }
    .meta-label {
        color: #999;
    }
    .meta-value {
        color: #333;
        font-weight: 500;
    }

    .resource-actions {
        display: flex;
        gap: 10px;
        margin-bottom: 30px;
    }
    .action-btn {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 10px 20px;
        border: 1px solid #ddd;
        background-color: white;
        border-radius: 25px;
        font-size: 16px;
        cursor: pointer;
        transition: all 0.3s;
    }
    .action-btn:hover {
        background-color: #f5f5f5;
        transform: translateY(-2px);
    }
    .action-btn .icon {
        font-size: 18px;
    }
    .action-btn .count {
        font-weight: 600;
    }

    .section {
        margin-bottom: 30px;
    }
    .section-title {
        font-size: 20px;
        margin-bottom: 15px;
        color: #333;
        border-left: 4px solid #007bff;
        padding-left: 10px;
    }
    .section-content {
        line-height: 1.8;
        color: #444;
    }
    .no-content {
        color: #999;
        font-style: italic;
    }

    .resource-info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 15px;
    }
    .info-item {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px;
        background-color: #f9f9f9;
        border-radius: 6px;
    }
    .info-label {
        color: #666;
        font-weight: 500;
        min-width: 80px;
    }
    .info-value {
        color: #333;
        flex: 1;
    }
    .keyword-tag {
        display: inline-block;
        background-color: #e3f2fd;
        color: #1976d2;
        padding: 3px 10px;
        border-radius: 15px;
        font-size: 12px;
        margin-right: 5px;
        margin-bottom: 5px;
    }

    .link-section {
        background-color: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
    }
    .link-container {
        display: flex;
        gap: 15px;
        align-items: center;
        margin-bottom: 10px;
    }
    .link-box {
        flex: 1;
        display: flex;
        gap: 10px;
    }
    .link-input {
        flex: 1;
        padding: 12px 15px;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-size: 14px;
        background-color: white;
        color: #333;
    }
    .copy-btn {
        padding: 12px 25px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 14px;
        cursor: pointer;
        transition: background-color 0.3s;
    }
    .copy-btn:hover {
        background-color: #0056b3;
    }
    .direct-link-btn {
        padding: 12px 25px;
        background-color: #28a745;
        color: white;
        text-decoration: none;
        border-radius: 6px;
        font-size: 14px;
        transition: background-color 0.3s;
    }
    .direct-link-btn:hover {
        background-color: #218838;
        color: white;
    }
    .copy-tips {
        color: #666;
        font-size: 13px;
        text-align: center;
    }

    .screenshot-container {
        text-align: center;
    }
    .screenshot-img {
        max-width: 100%;
        max-height: 500px;
        border-radius: 4px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        object-fit: contain; /* ä¿æŒå›¾ç‰‡æ¯”ä¾‹ï¼Œå®Œæ•´æ˜¾ç¤º */
    }

    .related-resources {
        margin-top: 40px;
    }
    .related-title {
        font-size: 22px;
        margin-bottom: 20px;
        color: #333;
        border-left: 4px solid #ff6b6b;
        padding-left: 10px;
    }
    .related-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
    }
    .related-card {
        background-color: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        transition: all 0.3s;
    }
    .related-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.15);
    }
    .related-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
    }
    .related-category {
        background-color: #e3f2fd;
        color: #1976d2;
        padding: 3px 8px;
        border-radius: 4px;
        font-size: 12px;
    }
    .related-cloud {
        background-color: #f3e5f5;
        color: #7b1fa2;
        padding: 3px 8px;
        border-radius: 4px;
        font-size: 12px;
    }
    .related-resource-title {
        margin-bottom: 10px;
    }
    .related-resource-title a {
        color: #333;
        text-decoration: none;
        font-size: 16px;
        line-height: 1.4;
    }
    .related-resource-title a:hover {
        color: #007bff;
    }
    .related-meta {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-top: 10px;
        border-top: 1px solid #eee;
        font-size: 12px;
        color: #888;
    }
    .related-stats {
        display: flex;
        gap: 10px;
    }
    .screenshots-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 15px;
    }
    .screenshot-item {
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        background-color: #f8f9fa;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 10px;
        min-height: 200px;
    }
    .screenshot-item:hover {
        transform: translateY(-5px);
    }

    @media (max-width: 768px) {
        .screenshots-container {
            grid-template-columns: 1fr;
        }
        .screenshot-item {
            min-height: 150px;
        }
        .screenshot-img {
            max-height: 400px;
        }
        .resource-detail-container {
            padding: 20px;
        }
        .resource-title {
            font-size: 22px;
        }
        .resource-meta {
            flex-direction: column;
            gap: 10px;
        }
        .resource-actions {
            flex-wrap: wrap;
        }
        .link-container {
            flex-direction: column;
        }
        .link-box {
            width: 100%;
        }
        .resource-info-grid {
            grid-template-columns: 1fr;
        }
        .related-grid {
            grid-template-columns: 1fr;
        }
    }
</style>

<!-- JavaScript -->
<script>
    // ç”¨æˆ·ç™»å½•çŠ¶æ€
    const userAuthenticated = {% if user.is_authenticated %}true{% else %}false{% endif %};
        // å¤åˆ¶å…³é”®è¯åŠŸèƒ½
    function copyKeywords() {
        const keywords = "{{ resource.keywords }}";
        const keywordsList = keywords.split(',').map(k => k.trim()).join(', ');

        try {
            navigator.clipboard.writeText(keywordsList).then(() => {
                showKeywordsTips('å…³é”®è¯å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            });
        } catch (err) {
            // å…¼å®¹æ—§æµè§ˆå™¨
            const textArea = document.createElement("textarea");
            textArea.value = keywordsList;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            showKeywordsTips('å…³é”®è¯å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
        }
    }

    function showKeywordsTips(message) {
        // æˆ‘ä»¬å¯ä»¥é‡ç”¨å·²æœ‰çš„copy-tipså…ƒç´ ï¼Œæˆ–è€…åˆ›å»ºä¸€ä¸ªæ–°çš„
        const tips = document.getElementById('copy-tips');
        if (tips) {
            tips.textContent = message;
            tips.style.color = '#28a745';

            setTimeout(() => {
                tips.textContent = '';
            }, 3000);
        } else {
            // å¦‚æœcopy-tipså…ƒç´ ä¸å­˜åœ¨ï¼Œåˆ›å»ºä¸€ä¸ªä¸´æ—¶æç¤º
            const tempTips = document.createElement('div');
            tempTips.textContent = message;
            tempTips.style.cssText = 'position: fixed; top: 20px; right: 20px; background: #28a745; color: white; padding: 10px 15px; border-radius: 4px; z-index: 1000;';
            document.body.appendChild(tempTips);

            setTimeout(() => {
                document.body.removeChild(tempTips);
            }, 3000);
        }
    }
    // å¤åˆ¶é“¾æ¥åŠŸèƒ½
// è¾…åŠ©å‡½æ•°ï¼šè·å–CSRF Tokenï¼ˆå¦‚æœå°šæœªå®šä¹‰ï¼‰
function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

// ä»Cookieä¸­è·å–CSRFä»¤ç‰Œçš„è¾…åŠ©å‡½æ•°
function getCSRFToken() {
    let cookieValue = null;
    const name = 'csrftoken';
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}
// å¤åˆ¶é“¾æ¥åŠŸèƒ½ï¼ˆå·²é›†æˆè®¡æ•°æ›´æ–°ï¼‰
function copyResourceLink() {
    const linkInput = document.getElementById('resource-link');
    // ä»æ­¥éª¤ä¸‰æ·»åŠ çš„éšè—å…ƒç´ ä¸­è·å–å½“å‰èµ„æºçš„ID
    const resourceIdElem = document.getElementById('resource-data');

    // å®‰å…¨æ£€æŸ¥ï¼šç¡®ä¿å¿…è¦çš„å…ƒç´ éƒ½å­˜åœ¨
    if (!resourceIdElem) {
        console.error('é”™è¯¯ï¼šæœªæ‰¾åˆ°å­˜å‚¨èµ„æºIDçš„å…ƒç´ ã€‚è¯·æ£€æŸ¥æ¨¡æ¿æ˜¯å¦æ­£ç¡®æ·»åŠ äº† <div id=\"resource-data\">ã€‚');
        showCopyTips('å¤åˆ¶å¤±è´¥ï¼šé¡µé¢é…ç½®é”™è¯¯');
        return;
    }
    const resourceId = resourceIdElem.dataset.resourceId;

    linkInput.select();
    linkInput.setSelectionRange(0, 99999); // å¯¹äºç§»åŠ¨è®¾å¤‡

    // ç¬¬ä¸€æ­¥ï¼šæ‰§è¡Œå¤åˆ¶åˆ°å‰ªè´´æ¿çš„æ“ä½œ
    const copyPromise = navigator.clipboard?.writeText ?
        navigator.clipboard.writeText(linkInput.value) :
        new Promise((resolve, reject) => {
            try {
                const successful = document.execCommand('copy');
                successful ? resolve() : reject(new Error('execCommand å¤åˆ¶å¤±è´¥'));
            } catch (e) {
                reject(e);
            }
        });

    copyPromise
        .then(() => {
            // å¤åˆ¶æˆåŠŸï¼Œæ˜¾ç¤ºæç¤º
            showCopyTips('é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');

            // ç¬¬äºŒæ­¥ï¼šå¤åˆ¶æˆåŠŸåï¼Œå¼‚æ­¥å‘é€è®¡æ•°æ›´æ–°è¯·æ±‚
            fetch(`/resource/${resourceId}/increase-copy/`, {
                method: 'POST',
                headers: {
                    'X-CSRFToken': getCSRFToken(), // éœ€è¦è·å–CSRFä»¤ç‰Œçš„å‡½æ•°
                    'Content-Type': 'application/json',
                },
            })
            .then(response => {
                if (!response.ok) {
                    // å¦‚æœHTTPçŠ¶æ€ç ä¸æ˜¯2xxï¼ŒæŠ›å‡ºé”™è¯¯
                    throw new Error(`HTTPé”™è¯¯! çŠ¶æ€ç : ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                // æ ¹æ®åç«¯è¿”å›çš„JSONè¿›è¡Œåˆ¤æ–­
                if (data.status === 'success') {
                    console.log(`âœ… å¤åˆ¶æ¬¡æ•°æ›´æ–°æˆåŠŸï¼Œæ–°æ¬¡æ•°: ${data.new_count}`);
                    // ï¼ˆå¯é€‰ï¼‰æœªæ¥å¯ä»¥åœ¨è¿™é‡Œæ›´æ–°é¡µé¢ä¸Šçš„è®¡æ•°æ˜¾ç¤º
                } else {
                    console.warn('å¤åˆ¶æ¬¡æ•°æ›´æ–°è¿”å›äº†é”™è¯¯çŠ¶æ€:', data.message);
                }
            })
            .catch(error => {
                // ç½‘ç»œé”™è¯¯æˆ–JSONè§£æé”™è¯¯ç­‰
                console.error('âŒ æ›´æ–°å¤åˆ¶æ¬¡æ•°æ—¶å‘ç”Ÿé”™è¯¯:', error);
                // æ³¨æ„ï¼šè¿™é‡Œé€‰æ‹©é™é»˜å¤±è´¥ï¼Œä¸å¹²æ‰°ç”¨æˆ·å¤åˆ¶æˆåŠŸçš„ä½“éªŒ
            });
        })
        .catch(err => {
            // å¤åˆ¶åˆ°å‰ªè´´æ¿å¤±è´¥
            console.error('âŒ å¤åˆ¶é“¾æ¥åˆ°å‰ªè´´æ¿å¤±è´¥:', err);
            showCopyTips('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰ä¸­é“¾æ¥è¿›è¡Œå¤åˆ¶');
        });
    }

    function showCopyTips(message) {
        showKeywordsTips(message); // é‡ç”¨åŒä¸€ä¸ªæç¤ºå‡½æ•°
    }

    // ç‚¹èµåŠŸèƒ½
    document.querySelectorAll('.like-btn').forEach(btn => {
    btn.addEventListener('click', function() {
        const resourceId = this.getAttribute('data-resource-id');
        const likeBtn = this;

        // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ç™»å½•
        if (!userAuthenticated) {
            if (confirm('æ‚¨éœ€è¦ç™»å½•åæ‰èƒ½ç‚¹èµï¼Œæ˜¯å¦ç«‹å³ç™»å½•ï¼Ÿ')) {
                const currentUrl = window.location.pathname;
                window.location.href = `/accounts/login/?next=${encodeURIComponent(currentUrl)}`;
            }
            return;
        }

        // å‘é€ç‚¹èµè¯·æ±‚
        fetch(`/resource/${resourceId}/like/`, {
            method: 'POST',
            headers: {
                'X-CSRFToken': getCSRFToken(),
                'Content-Type': 'application/json'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.status === 'success') {
                // æ›´æ–°ç‚¹èµæŒ‰é’®çŠ¶æ€
                if (data.liked) {
                    likeBtn.classList.add('liked');
                    likeBtn.innerHTML = `<span class="icon">ğŸ‘</span><span class="count">${data.like_count}</span>`;
                } else {
                    likeBtn.classList.remove('liked');
                    likeBtn.innerHTML = `<span class="icon">ğŸ‘</span><span class="count">${data.like_count}</span>`;
                }

                // æ›´æ–°é¡µé¢ä¸Šçš„ç‚¹èµæ•°æ˜¾ç¤º
                const countElement = likeBtn.querySelector('.count');
                if (countElement) {
                    countElement.textContent = data.like_count;
                }

                // æ˜¾ç¤ºæç¤º
                showMessage(data.liked ? 'ç‚¹èµæˆåŠŸï¼' : 'å·²å–æ¶ˆç‚¹èµ', 'success');
            } else {
                showMessage('æ“ä½œå¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            showMessage('ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•', 'error');
        });
    });
    });
        // è·å–CSRF Tokençš„å‡½æ•°
    function getCSRFToken() {
    const name = 'csrftoken';
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
    }

    // æ˜¾ç¤ºæ¶ˆæ¯çš„å‡½æ•°
    function showMessage(message, type = 'info') {
    // åˆ›å»ºä¸€ä¸ªæ¶ˆæ¯å…ƒç´ 
    const messageDiv = document.createElement('div');
    messageDiv.textContent = message;
    messageDiv.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 15px 25px;
        border-radius: 5px;
        color: white;
        font-weight: bold;
        z-index: 9999;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        animation: slideIn 0.3s ease-out;
    `;

    // æ ¹æ®æ¶ˆæ¯ç±»å‹è®¾ç½®èƒŒæ™¯è‰²
    if (type === 'success') {
        messageDiv.style.backgroundColor = '#28a745';
    } else if (type === 'error') {
        messageDiv.style.backgroundColor = '#dc3545';
    } else {
        messageDiv.style.backgroundColor = '#17a2b8';
    }

    document.body.appendChild(messageDiv);

    // 3ç§’åè‡ªåŠ¨ç§»é™¤
    setTimeout(() => {
        messageDiv.style.animation = 'slideOut 0.3s ease-out';
        setTimeout(() => {
            document.body.removeChild(messageDiv);
        }, 300);
    }, 3000);
    }

    // æ·»åŠ åŠ¨ç”»å…³é”®å¸§
    const style = document.createElement('style');
    style.textContent = '@keyframes slideIn {' +
        'from { transform: translateX(100%); opacity: 0; }' +
        'to { transform: translateX(0); opacity: 1; }' +
        '}' +
        '@keyframes slideOut {' +
        'from { transform: translateX(0); opacity: 1; }' +
        'to { transform: translateX(100%); opacity: 0; }' +
        '}';
    document.head.appendChild(style);
    // æ”¶è—åŠŸèƒ½
    document.querySelectorAll('.favorite-btn').forEach(btn => {
    btn.addEventListener('click', function() {
        const resourceId = this.getAttribute('data-resource-id');
        const favoriteBtn = this;

        // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ç™»å½•
        if (!userAuthenticated) {
            if (confirm('æ‚¨éœ€è¦ç™»å½•åæ‰èƒ½æ”¶è—ï¼Œæ˜¯å¦ç«‹å³ç™»å½•ï¼Ÿ')) {
                const currentUrl = window.location.pathname;
                window.location.href = `/accounts/login/?next=${encodeURIComponent(currentUrl)}`;
            }
            return;
        }

        // å‘é€æ”¶è—è¯·æ±‚
        fetch(`/resource/${resourceId}/favorite/`, {
            method: 'POST',
            headers: {
                'X-CSRFToken': getCSRFToken(),
                'Content-Type': 'application/json'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.status === 'success') {
                // æ›´æ–°æ”¶è—æŒ‰é’®çŠ¶æ€
                if (data.favorited) {
                    favoriteBtn.classList.add('favorited');
                    favoriteBtn.innerHTML = `<span class="icon">â­</span><span class="count">${data.collect_count}</span>`;
                } else {
                    favoriteBtn.classList.remove('favorited');
                    favoriteBtn.innerHTML = `<span class="icon">â­</span><span class="count">${data.collect_count}</span>`;
                }

                // æ›´æ–°é¡µé¢ä¸Šçš„æ”¶è—æ•°æ˜¾ç¤º
                const countElement = favoriteBtn.querySelector('.count');
                if (countElement) {
                    countElement.textContent = data.collect_count;
                }

                // æ˜¾ç¤ºæç¤º
                showMessage(data.favorited ? 'æ”¶è—æˆåŠŸï¼' : 'å·²å–æ¶ˆæ”¶è—', 'success');
            } else {
                showMessage('æ“ä½œå¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            showMessage('ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•', 'error');
        });
    });
});
// è¯„è®ºåŠŸèƒ½
document.addEventListener('DOMContentLoaded', function() {
    // å­—ç¬¦è®¡æ•°
    const commentTextarea = document.getElementById('comment-content');
    const charCount = document.querySelector('.char-count');

    if (commentTextarea && charCount) {
        commentTextarea.addEventListener('input', function() {
            const currentLength = this.value.length;
            charCount.textContent = `${currentLength}/200`;

            // å¦‚æœè¶…è¿‡200å­—ï¼Œæ˜¾ç¤ºè­¦å‘Š
            if (currentLength > 200) {
                charCount.style.color = '#dc3545';
            } else {
                charCount.style.color = '#6c757d';
            }
        });
    }

    // è¯„è®ºè¡¨å•æäº¤
    const commentForm = document.getElementById('comment-form');
    if (commentForm) {
        commentForm.addEventListener('submit', function(e) {
            e.preventDefault();

            // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ç™»å½•
            if (!userAuthenticated) {
                if (confirm('æ‚¨éœ€è¦ç™»å½•åæ‰èƒ½è¯„è®ºï¼Œæ˜¯å¦ç«‹å³ç™»å½•ï¼Ÿ')) {
                    const currentUrl = window.location.pathname;
                    window.location.href = `/accounts/login/?next=${encodeURIComponent(currentUrl)}`;
                }
                return;
            }

            const resourceId = window.location.pathname.match(/\/resource\/(\d+)\//);
            if (!resourceId) return;

            const content = document.getElementById('comment-content').value.trim();

            if (!content) {
                showMessage('è¯„è®ºå†…å®¹ä¸èƒ½ä¸ºç©º', 'error');
                return;
            }

            if (content.length > 200) {
                showMessage('è¯„è®ºå†…å®¹ä¸èƒ½è¶…è¿‡200å­—', 'error');
                return;
            }

            // ç¦ç”¨æäº¤æŒ‰é’®ï¼Œé˜²æ­¢é‡å¤æäº¤
            const submitBtn = commentForm.querySelector('.submit-comment-btn');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'æäº¤ä¸­...';

            // å‘é€è¯„è®ºè¯·æ±‚
            fetch(`/resource/${resourceId[1]}/comment/`, {
                method: 'POST',
                headers: {
                    'X-CSRFToken': getCSRFToken(),
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: new URLSearchParams({
                    'content': content
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    // æ¸…ç©ºæ–‡æœ¬æ¡†
                    commentTextarea.value = '';
                    charCount.textContent = '0/200';

                    // æ·»åŠ æ–°è¯„è®ºåˆ°åˆ—è¡¨
                    addCommentToUI(data);

                    // æ›´æ–°è¯„è®ºæ•°é‡
                    document.querySelector('.section-title').textContent = `è¯„è®ºï¼ˆ${data.comment_count}æ¡ï¼‰`;

                    // æ›´æ–°èµ„æºé¡µé¢ä¸Šçš„è¯„è®ºæ•°
                    const commentBtn = document.querySelector('.comment-btn .count');
                    if (commentBtn) {
                        commentBtn.textContent = data.comment_count;
                    }

                    showMessage('è¯„è®ºå‘è¡¨æˆåŠŸ', 'success');
                } else {
                    showMessage(data.message || 'è¯„è®ºå‘è¡¨å¤±è´¥', 'error');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                showMessage('ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•', 'error');
            })
            .finally(() => {
                // æ¢å¤æäº¤æŒ‰é’®
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            });
        });
    }
});

// æ·»åŠ è¯„è®ºåˆ°UI
function addCommentToUI(commentData) {
    const commentsList = document.getElementById('comments-list');
    const noComments = commentsList.querySelector('.no-comments');

    // å¦‚æœæ²¡æœ‰è¯„è®ºçš„æç¤ºå­˜åœ¨ï¼Œç§»é™¤å®ƒ
    if (noComments) {
        noComments.remove();
    }

    // åˆ›å»ºæ–°çš„è¯„è®ºå…ƒç´ 
    const commentItem = document.createElement('div');
    commentItem.className = 'comment-item';
    commentItem.dataset.commentId = commentData.comment_id;

    commentItem.innerHTML = `
        <div class="comment-header">
            <span class="comment-author">${commentData.username}</span>
            <span class="comment-time">${commentData.created_at}</span>
        </div>
        <div class="comment-content">
            ${commentData.content.replace(/\n/g, '<br>')}
        </div>
        <div class="comment-actions">
            <button class="delete-comment-btn" onclick="deleteComment(${commentData.comment_id})">åˆ é™¤</button>
        </div>
    `;

    // å°†æ–°è¯„è®ºæ·»åŠ åˆ°åˆ—è¡¨é¡¶éƒ¨
    commentsList.insertBefore(commentItem, commentsList.firstChild);
}

// åˆ é™¤è¯„è®º
function deleteComment(commentId) {
    if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡è¯„è®ºå—ï¼Ÿ')) {
        return;
    }

    fetch(`/comment/${commentId}/delete/`, {
        method: 'POST',
        headers: {
            'X-CSRFToken': getCSRFToken(),
            'Content-Type': 'application/json'
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.status === 'success') {
            // ä»UIä¸­ç§»é™¤è¯„è®º
            const commentElement = document.querySelector(`.comment-item[data-comment-id="${commentId}"]`);
            if (commentElement) {
                commentElement.remove();
            }

            // æ›´æ–°è¯„è®ºæ•°é‡
            const currentTitle = document.querySelector('.section-title').textContent;
            const match = currentTitle.match(/è¯„è®º\ï¼ˆ(\d+)æ¡\ï¼‰/) || ['è¯„è®ºï¼ˆ0æ¡ï¼‰', '0'];
            const newCount = data.comment_count || parseInt(match[1]) - 1;
            document.querySelector('.section-title').textContent = `è¯„è®ºï¼ˆ${newCount}æ¡ï¼‰`;

            // æ›´æ–°èµ„æºé¡µé¢ä¸Šçš„è¯„è®ºæ•°
            const commentBtn = document.querySelector('.comment-btn .count');
            if (commentBtn) {
                commentBtn.textContent = newCount;
            }

            // å¦‚æœæ²¡æœ‰è¯„è®ºäº†ï¼Œæ˜¾ç¤ºæç¤º
            const commentsList = document.getElementById('comments-list');
            if (commentsList.children.length === 0) {
                const noComments = document.createElement('div');
                noComments.className = 'no-comments';
                noComments.textContent = 'æš‚æ— è¯„è®ºï¼Œå¿«æ¥å‘è¡¨ç¬¬ä¸€æ¡è¯„è®ºå§ï¼';
                commentsList.appendChild(noComments);
            }

            showMessage('è¯„è®ºå·²åˆ é™¤', 'success');
        } else {
            showMessage(data.message || 'åˆ é™¤å¤±è´¥', 'error');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        showMessage('ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•', 'error');
    });
}
// å¹³æ»‘æ»šåŠ¨åˆ°æŒ‡å®šå…ƒç´ 
function smoothScrollToElement(elementId) {
    const element = document.getElementById(elementId);
    if (element) {
        element.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
        });
    }
}

// ä¸ºè¯„è®ºæŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶
document.querySelectorAll('.comment-btn').forEach(btn => {
    btn.addEventListener('click', function(e) {
        e.preventDefault();
        smoothScrollToElement('comments-section');
    });
});
// å¹³æ»‘æ»šåŠ¨åˆ°é¡µé¢é¡¶éƒ¨
function smoothScrollToTop() {
    window.scrollTo({
        top: 0,
        behavior: 'smooth'
    });
}

// å½“æ»šåŠ¨åˆ°ä¸€å®šä½ç½®æ—¶æ˜¾ç¤º/éšè—è¿”å›é¡¶éƒ¨æŒ‰é’®
window.addEventListener('scroll', function() {
    const backToTopBtn = document.querySelector('.back-to-top-btn');
    if (backToTopBtn) {
        if (window.scrollY > 300) {
            backToTopBtn.style.opacity = '1';
            backToTopBtn.style.visibility = 'visible';
        } else {
            backToTopBtn.style.opacity = '0';
            backToTopBtn.style.visibility = 'hidden';
        }
    }
});

// åˆå§‹åŒ–è¿”å›é¡¶éƒ¨æŒ‰é’®çš„æ ·å¼
document.addEventListener('DOMContentLoaded', function() {
    const backToTopBtn = document.querySelector('.back-to-top-btn');
    if (backToTopBtn) {
        backToTopBtn.style.transition = 'opacity 0.3s, visibility 0.3s';
        backToTopBtn.style.opacity = '0';
        backToTopBtn.style.visibility = 'hidden';
    }
});
// ä¸¾æŠ¥åŠŸèƒ½
document.querySelectorAll('.report-btn').forEach(btn => {
    btn.addEventListener('click', function() {
        const resourceId = this.getAttribute('data-resource-id');
        const reportBtn = this;

        // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ç™»å½•
        if (!userAuthenticated) {
            if (confirm('æ‚¨éœ€è¦ç™»å½•åæ‰èƒ½ä¸¾æŠ¥ï¼Œæ˜¯å¦ç«‹å³ç™»å½•ï¼Ÿ')) {
                const currentUrl = window.location.pathname;
                window.location.href = `/accounts/login/?next=${encodeURIComponent(currentUrl)}`;
            }
            return;
        }

        // ç¡®è®¤ä¸¾æŠ¥
        if (!confirm('ç¡®å®šè¦ä¸¾æŠ¥æ­¤èµ„æºå—ï¼Ÿä¸¾æŠ¥åå°†æ— æ³•æ’¤é”€ã€‚')) {
            return;
        }

        // ç¦ç”¨æŒ‰é’®ï¼Œé˜²æ­¢é‡å¤ç‚¹å‡»
        reportBtn.disabled = true;
        const originalText = reportBtn.innerHTML;
        reportBtn.innerHTML = '<span class="icon">â³</span><span class="count">å¤„ç†ä¸­...</span>';

        // å‘é€ä¸¾æŠ¥è¯·æ±‚
        fetch(`/resource/${resourceId}/report/`, {
            method: 'POST',
            headers: {
                'X-CSRFToken': getCSRFToken(),
                'Content-Type': 'application/json'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.status === 'success') {
                // æ›´æ–°é¡µé¢ä¸Šçš„ä¸¾æŠ¥æ•°æ˜¾ç¤º
                const countElement = reportBtn.querySelector('.count');
                if (countElement) {
                    countElement.textContent = data.report_count;
                }

                // ç¦ç”¨ä¸¾æŠ¥æŒ‰é’®ï¼Œå› ä¸ºç”¨æˆ·å·²ç»ä¸¾æŠ¥è¿‡äº†
                reportBtn.disabled = true;
                reportBtn.innerHTML = '<span class="icon">âœ…</span><span class="count">å·²ä¸¾æŠ¥</span>';
                reportBtn.classList.add('reported');

                showMessage(data.message, 'success');
            } else {
                // æ¢å¤æŒ‰é’®çŠ¶æ€
                reportBtn.disabled = false;
                reportBtn.innerHTML = originalText;
                showMessage(data.message, 'error');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            // æ¢å¤æŒ‰é’®çŠ¶æ€
            reportBtn.disabled = false;
            reportBtn.innerHTML = originalText;
            showMessage('ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•', 'error');
        });
    });
});
// é¡µé¢åŠ è½½æ—¶æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç»ä¸¾æŠ¥è¿‡æ­¤èµ„æº
document.addEventListener('DOMContentLoaded', function() {
    if (userAuthenticated) {
        // è¿™é‡Œå¯ä»¥æ·»åŠ ä¸€ä¸ªAPIæ¥æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç»ä¸¾æŠ¥è¿‡
        // ä½†ç”±äºç®€åŒ–è®¾è®¡ï¼Œæˆ‘ä»¬ä¾é UIçŠ¶æ€æ¥ç®¡ç†
        const reportBtn = document.querySelector('.report-btn');
        if (reportBtn && reportBtn.classList.contains('reported')) {
            reportBtn.disabled = true;
            reportBtn.innerHTML = '<span class="icon">âœ…</span><span class="count">å·²ä¸¾æŠ¥</span>';
        }
    }
});
</script>
{% endblock %}